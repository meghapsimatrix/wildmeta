<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="wildmeta">
<title>Cluster Wild Bootstrapping for Meta-Analysis • wildmeta</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cluster Wild Bootstrapping for Meta-Analysis">
<meta property="og:description" content="wildmeta">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">wildmeta</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/cwbmeta.html">Cluster Wild Bootstrapping for Meta-Analysis</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/meghapsimatrix/wildmeta/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Cluster Wild Bootstrapping for Meta-Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/meghapsimatrix/wildmeta/blob/HEAD/vignettes/cwbmeta.Rmd" class="external-link"><code>vignettes/cwbmeta.Rmd</code></a></small>
      <div class="d-none name"><code>cwbmeta.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="dependence-in-meta-analysis">Dependence in Meta-Analysis<a class="anchor" aria-label="anchor" href="#dependence-in-meta-analysis"></a>
</h2>
<p>Typical methods to conduct meta-analysis or meta-regression work
under the assumption that the effect size estimates are independent.
However, primary studies often report multiple, statistically dependent
estimates of effect sizes. Dependent effect sizes can occur through
correlated effects structure, a hierarchical effects structure, or a
combination of the two <span class="citation">(Hedges, Tipton, &amp;
Johnson, 2010; Pustejovsky &amp; Tipton, 2021)</span>. A correlated
effects data structure typically occurs due to multiple correlated
measures of an outcome, repeated measures of the outcome data, or
comparison of multiple treatment groups to the same control group <span class="citation">(Hedges et al., 2010)</span>. A hierarchical effects
structure typically occurs when the meta-analysis includes multiple
primary studies conducted by the same researcher, by the same lab, or in
the same region <span class="citation">(Hedges et al., 2010)</span>.</p>
<p>Researchers may be inclined to ignore dependence and use methods that
assume that each effect size estimate is independent. However, doing so
can result in inaccurate standard errors and, consequently, hypothesis
tests with incorrect Type I error rates and confidence intervals with
incorrect coverage levels <span class="citation">(Becker, 2000)</span>.
Ad-hoc methods for handling dependence include averaging effect sizes by
study or selecting a single effect size per study. These methods result
in loss of information and are not suitable for studying within-study
variation in effect sizes <span class="citation">(Hedges et al.,
2010)</span>. A method called shifting the unit-of-analysis involves
running meta-analytic models for different subsets of the data <span class="citation">(Cooper, 1998)</span>. However, this strategy is not
useful if a researcher wants to summarize effects across the subsets or
study differential effects <span class="citation">(Becker,
2000)</span>.</p>
<p>The ideal solution for handling dependence would be to use a
multivariate model <span class="citation">(Becker, 2000; Hedges et al.,
2010)</span>. This approach explicitly models dependence among the
effect sizes <span class="citation">(Becker, 2000; Hedges et al.,
2010)</span>. However, multivariate meta-analysis requires knowledge of
correlations or covariances between pairs of effect size estimates
within each study, which are often difficult to obtain from primary
studies.</p>
<p>To handle dependence without knowing the covariance structure between
effect size estimates, <span class="citation">Hedges et al.
(2010)</span> proposed the use of robust variance estimation (RVE). RVE
involves estimating the variances for the meta-regression model’s
coefficients using sandwich estimators that are valid even when the
covariance structure is unknown or mis-specified <span class="citation">(Hedges et al., 2010)</span>. However, the performance
characteristics of RVE are asymptotic in that a large number of clusters
or studies is required to provide accurate standard error estimates
<span class="citation">(Hedges et al., 2010)</span>. If the number of
studies in a meta-analysis is small, RVE, as originally proposed by
<span class="citation">Hedges et al. (2010)</span>, can result in
downwardly biased standard errors and inflation of Type I error rates
<span class="citation">(Hedges et al., 2010; Tipton, 2015)</span>.</p>
<p><span class="citation">Tipton (2015)</span> and <span class="citation">Tipton &amp; Pustejovsky (2015)</span> examined several
small sample correction methods to improve the performance of RVE. <span class="citation">Tipton (2015)</span> recommended CR2 type correction
for RVE as well as the use of Satterthwaite degrees of freedom for
single coefficient tests. <span class="citation">Tipton &amp;
Pustejovsky (2015)</span> examined corrections for multiple-contrast
hypothesis tests. <span class="citation">Tipton &amp; Pustejovsky
(2015)</span> found that the HTZ test, which is an extension of the CR2
correction method with the Satterthwaite degrees of freedom, controlled
Type 1 error rate adequately even when the number of studies was small.
However, <span class="citation">Joshi, Pustejovsky, &amp; Beretvas
(2022)</span> showed, through simulations, that the HTZ test can be
conservative. The authors examined another method, cluster wild
bootstrapping (CWB), that has been studied in the econometrics
literature but not in the meta-analytic context. The results of the
simulations from <span class="citation">Joshi et al. (2022)</span>
showed that CWB adequately controlled for Type 1 error rate and provided
higher power than the HTZ test, especially for multiple-contrast
hypothesis tests.</p>
</div>
<div class="section level2">
<h2 id="bootstrapping">Bootstrapping<a class="anchor" aria-label="anchor" href="#bootstrapping"></a>
</h2>
<p>General bootstrapping can be used to estimate measures of
uncertainty, like standard errors, p-values and confidence intervals,
even when other methods fail <span class="citation">(Boos et al.,
2003)</span>. Bootstrapping involves re-sampling from the original data
many times to create an empirical distribution which is used in place of
the distribution of an estimate or test statistic <span class="citation">(Boos et al., 2003)</span>.</p>
<p>Several bootstrapping data generating processes are available. The
most common one is pair bootstrapping, which involves re-sampling with
replacement the set of outcome and covariate data for each case <span class="citation">(Freedman, 1981, 1984)</span>. For data involving
clusters, the entire cluster is re-sampled <span class="citation">(Cameron, Gelbach, &amp; Miller, 2008)</span>. In
meta-analytic studies with small number of clusters, pairs bootstrapping
can result in lack of variance in the distribution of covariates
rendering estimation of coefficients infeasible <span class="citation">(Cameron et al., 2008)</span>.</p>
<p>Another type of bootstrapping involves re-sampling residuals <span class="citation">(Cameron et al., 2008)</span>. In case with clusters,
entire vector of residuals for each cluster is re-sampled <span class="citation">(Cameron et al., 2008; MacKinnon, 2009)</span>. Such a
procedure requires clusters to be of equal size and has an underlying
assumption that the errors are independently and identically distributed
<span class="citation">(MacKinnon, 2009)</span>.</p>
<p>An ideal way to bootstrap when the number of clusters is small is to
use cluster wild bootstrapping, which involves sampling weights and
multiplying residuals with the random weights <span class="citation">(Cameron et al., 2008; MacKinnon, 2009)</span>. In
contrast to the process of pair bootstrapping, the process of CWB does
not involve re-sampling the distribution of predictor variables. Thus,
the problem of lack of variance in covariates due to re-sampling does
not occur with CWB <span class="citation">(Cameron et al., 2008;
MacKinnon, 2009)</span>. Further, in contrast to residual bootstrapping,
CWB does not require clusters to have the same size and does not require
the errors to be independently and identically distributed <span class="citation">(Cameron et al., 2008; MacKinnon, 2009)</span>.</p>
<div class="section level3">
<h3 id="cluster-wild-bootstrapping">Cluster Wild Bootstrapping<a class="anchor" aria-label="anchor" href="#cluster-wild-bootstrapping"></a>
</h3>
<p>This section provides an overview of the cluster wild bootstrapping
algorithm.</p>
<p><span class="citation">MacKinnon (2009)</span> recommended imposing
the null hypothesis when running bootstrap hypothesis tests as the
process of hypothesis testing involves examining where the test
statistic lies on the the sampling distribution based on the null
hypothesis. For weights to use in cluster wild bootstrapping, <span class="citation">MacKinnon (2015)</span> and <span class="citation">Webb
(2013)</span> have shown that the Rademacher weights, which take on the
values of -1 and 1 with the probability of 0.5 each, outperform all
other types of weights for studies with number of clusters as low as
10.</p>
<p>The general process of conducting cluster wild bootstrapping is as
follows <span class="citation">(Cameron et al., 2008; MacKinnon,
2009)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a null model and a full model on the original data.</p></li>
<li><p>Obtain residuals from the null model.</p></li>
<li><p>Generate an auxiliary random variable that has mean of 0 and
variance of 1 and multiply the residuals by the random variable (e.g.,
Rademacher weights) set to be constant within clusters (CWB). The
residuals can also be multiplied by CR2 adjustment matrices before
multiplying by weights (CWB Adjusted). Adjusting the residuals by CR2
matrices can correct the under-estimation of the error variance when the
working model is incorrect <span class="citation">(Davidson &amp;
Flachaire, 2008; MacKinnon, 2006; Pustejovsky &amp; Tipton,
2018)</span>.</p></li>
<li><p>Obtain new outcome scores by adding the transformed residuals to
the predicted values from the null model fit on the original
data.</p></li>
<li><p>Re-estimate the full model with the new calculated outcome scores
and obtain the test statistic.</p></li>
<li><p>Repeat steps 3-5 <span class="math inline">\(R\)</span> times.
Calculate p-value:</p></li>
</ol>
<p><span class="math display">\[p = \frac{1}{R} \sum_{r = 1}^R
I\left(F^{(r)} &gt; F\right)\]</span></p>
<p>The results of the simulation studies conducted in <span class="citation">Joshi et al. (2022)</span> did not show any difference
in Type 1 error rates or power when multiplying the results by CR2
adjustments matrices. However, the authors did not study major
mis-specifications of the working model in the simulation studies.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-from-wildmeta">Example from <code>wildmeta</code><a class="anchor" aria-label="anchor" href="#example-from-wildmeta"></a>
</h2>
<p>This section presents examples of how to implement cluster wild
bootstrapping using functions from our <code>wildmeta</code> package.
The functions in our package work with models fit using
<code><a href="https://rdrr.io/pkg/robumeta/man/robu.html" class="external-link">robumeta::robu()</a></code> <span class="citation">(Fisher, Tipton,
&amp; Zhipeng, 2017)</span> and <code><a href="https://wviechtb.github.io/metafor/reference/rma.mv.html" class="external-link">metafor::rma.mv()</a></code> <span class="citation">(Viechtbauer, 2010)</span>.</p>
<div class="section level3">
<h3 id="robumeta-models">
<code>robumeta</code> models<a class="anchor" aria-label="anchor" href="#robumeta-models"></a>
</h3>
<p>The examples in this vignette utilize the <code>SATCoaching</code>
dataset from the <code>clubSandwich</code> package <span class="citation">(Pustejovsky, 2020)</span>, originally from <span class="citation">DerSimonian &amp; Laird (1983)</span>. The standardized
mean differences represent the effects of SAT coaching on SAT verbal
(SATV) and/or SAT math (SATM) scores.</p>
<p>The code below runs cluster wild bootstrapping to test the
multiple-contrast hypothesis that the effect of coaching does not differ
based on study type. The <code>study_type</code> variable indicates
whether groups compared in primary studies were matched, randomized, or
non-equivalent. The meta-regression model also controls for hours of
coaching provided (<code>hrs</code>) and whether the students took math
or verbal test (<code>test</code>). Below, we run a zero-intercept
meta-regression model.</p>
<p>The <code><a href="../reference/Wald_test_cwb.html">Wald_test_cwb()</a></code> function takes in a full model fit
using the <code><a href="https://rdrr.io/pkg/robumeta/man/robu.html" class="external-link">robumeta::robu()</a></code> function. Further, users need to
specify the constraint to be tested. Below, we create a constraint
matrix using <code><a href="http://jepusto.github.io/clubSandwich/reference/constraint_matrices.html" class="external-link">clubSandwich::constrain_equal()</a></code>; indices 1 to
3 correspond to the three levels of the <code>study_type</code>
variable. Users can specify the number of bootstrap replications R. In
the examples below, we set the value to 99 to speed up computation time.
In practice, we recommend using a higher number of bootstrap
replications, such as 1999. Using more replications will improve power.
Please see <span class="citation">Davidson &amp; MacKinnon (2000)</span>
for guidance on the number of bootstrap replications to use. Users can
also set the seed in the <code><a href="../reference/Wald_test_cwb.html">Wald_test_cwb()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://meghapsimatrix.github.io/wildmeta/index.html">wildmeta</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://jepusto.github.io/clubSandwich/" class="external-link">clubSandwich</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zackfisher/robumeta" class="external-link">robumeta</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">robu_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/robumeta/man/robu.html" class="external-link">robu</a></span><span class="op">(</span><span class="va">d</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">study_type</span> <span class="op">+</span> <span class="va">hrs</span> <span class="op">+</span> <span class="va">test</span>,</span>
<span>                   studynum <span class="op">=</span> <span class="va">study</span>,</span>
<span>                   var.eff.size <span class="op">=</span> <span class="va">V</span>,</span>
<span>                   small <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">SATcoaching</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Wald_test_cwb.html">Wald_test_cwb</a></span><span class="op">(</span>full_model <span class="op">=</span> <span class="va">robu_model</span>,</span>
<span>              constraints <span class="op">=</span> <span class="fu"><a href="http://jepusto.github.io/clubSandwich/reference/constraint_matrices.html" class="external-link">constrain_equal</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>              R <span class="op">=</span> <span class="fl">99</span>,</span>
<span>              seed <span class="op">=</span> <span class="fl">20201228</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Test Adjustment CR_type Statistic  R     p_val</span></span>
<span><span class="co">#&gt; 1  CWB        CR0     CR0   Naive-F 99 0.3131313</span></span></code></pre></div>
<p>The output of the function contains the name of the test, the
adjustment used for the bootstrap process, the type of
variance-covariance matrix used, the type of test statistic, the number
of bootstrap replicates, and the bootstrapped p-value.</p>
<p>The users can also specify whether to adjust the residuals with
<code>CR1</code> to <code>CR4</code>matrices when bootstrapping as
below. The default value for the <code>adjust</code> argument is set to
<code>CR0</code>. Below is an example where we set the adjust the
residuals using <code>CR2</code> matrices.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Wald_test_cwb.html">Wald_test_cwb</a></span><span class="op">(</span>full_model <span class="op">=</span> <span class="va">robu_model</span>,</span>
<span>              constraints <span class="op">=</span> <span class="fu"><a href="http://jepusto.github.io/clubSandwich/reference/constraint_matrices.html" class="external-link">constrain_equal</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>              R <span class="op">=</span> <span class="fl">99</span>,</span>
<span>              adjust <span class="op">=</span> <span class="st">"CR2"</span>,</span>
<span>              seed <span class="op">=</span> <span class="fl">20201229</span><span class="op">)</span></span>
<span><span class="co">#&gt;           Test Adjustment CR_type Statistic  R     p_val</span></span>
<span><span class="co">#&gt; 1 CWB Adjusted        CR2     CR0   Naive-F 99 0.4242424</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="metafor-models">
<code>metafor</code> models<a class="anchor" aria-label="anchor" href="#metafor-models"></a>
</h3>
<p>In the examples above, we used the <code><a href="https://rdrr.io/pkg/robumeta/man/robu.html" class="external-link">robumeta::robu()</a></code>
function to fit the full model. In this section, we fit the full model
using the <code><a href="https://wviechtb.github.io/metafor/reference/rma.mv.html" class="external-link">metafor::rma.mv()</a></code> function. (We use a small,
entirely insufficient number of replications in order to limit the
computing time of this vignette.)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.metafor-project.org" class="external-link">metafor</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">rma_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metafor/reference/rma.mv.html" class="external-link">rma.mv</a></span><span class="op">(</span>yi <span class="op">=</span> <span class="va">d</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">study_type</span> <span class="op">+</span> <span class="va">hrs</span> <span class="op">+</span> <span class="va">test</span>,</span>
<span>                    V <span class="op">=</span> <span class="va">V</span>,</span>
<span>                    random <span class="op">=</span> <span class="op">~</span> <span class="va">study_type</span> <span class="op">|</span> <span class="va">study</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">SATcoaching</span>,</span>
<span>                    subset <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">hrs</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Wald_test_cwb.html">Wald_test_cwb</a></span><span class="op">(</span>full_model <span class="op">=</span> <span class="va">rma_model</span>,</span>
<span>              constraints <span class="op">=</span> <span class="fu"><a href="http://jepusto.github.io/clubSandwich/reference/constraint_matrices.html" class="external-link">constrain_equal</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>              R <span class="op">=</span> <span class="fl">19</span>,</span>
<span>              seed <span class="op">=</span> <span class="fl">20210314</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Test Adjustment CR_type Statistic  R     p_val</span></span>
<span><span class="co">#&gt; 1  CWB        CR0     CR0   Naive-F 19 0.2105263</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="timing">Timing<a class="anchor" aria-label="anchor" href="#timing"></a>
</h3>
<div class="section level4">
<h4 id="robumeta-models-1">
<code>robumeta</code> models<a class="anchor" aria-label="anchor" href="#robumeta-models-1"></a>
</h4>
<p>The <code><a href="../reference/Wald_test_cwb.html">Wald_test_cwb()</a></code> function runs within a minute for
correlated effects models even when using a large number of bootstrap
replications. Below is an example with 1999 bootstrap replications.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Wald_test_cwb.html">Wald_test_cwb</a></span><span class="op">(</span>full_model <span class="op">=</span> <span class="va">robu_model</span>,</span>
<span>                       constraints <span class="op">=</span> <span class="fu"><a href="http://jepusto.github.io/clubSandwich/reference/constraint_matrices.html" class="external-link">constrain_equal</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                       R <span class="op">=</span> <span class="fl">1999</span>, </span>
<span>                       seed <span class="op">=</span> <span class="fl">20201229</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  20.870   0.448  22.499</span></span></code></pre></div>
<p>Computation speed can sometimes be improved by setting a parallel
processing plan using the <code>future</code> package:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu">parallelly</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/supportsMulticore.html" class="external-link">supportsMulticore</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multicore</span><span class="op">)</span> </span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/nbrOfWorkers.html" class="external-link">nbrOfWorkers</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; system </span></span>
<span><span class="co">#&gt;      4</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Wald_test_cwb.html">Wald_test_cwb</a></span><span class="op">(</span>full_model <span class="op">=</span> <span class="va">robu_model</span>,</span>
<span>                       constraints <span class="op">=</span> <span class="fu"><a href="http://jepusto.github.io/clubSandwich/reference/constraint_matrices.html" class="external-link">constrain_equal</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                       R <span class="op">=</span> <span class="fl">1999</span>, </span>
<span>                       seed <span class="op">=</span> <span class="fl">20201229</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   1.674   0.104  23.486</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="metafor-models-1">
<code>metafor</code> models<a class="anchor" aria-label="anchor" href="#metafor-models-1"></a>
</h4>
<p>CWB takes longer with models fit using
<code><a href="https://wviechtb.github.io/metafor/reference/rma.mv.html" class="external-link">metafor::rma.mv()</a></code>. Below is an example with 99 bootstrap
replications:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reps</span></span>
<span><span class="co">#&gt; [1] 99</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">res_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Wald_test_cwb.html">Wald_test_cwb</a></span><span class="op">(</span>full_model <span class="op">=</span> <span class="va">rma_model</span>,</span>
<span>                           constraints <span class="op">=</span> <span class="fu"><a href="http://jepusto.github.io/clubSandwich/reference/constraint_matrices.html" class="external-link">constrain_equal</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                           R <span class="op">=</span> <span class="va">reps</span>,</span>
<span>                           seed <span class="op">=</span> <span class="fl">20210314</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  22.501   2.872  25.810</span></span>
<span></span>
<span><span class="va">res_seq</span></span>
<span><span class="co">#&gt;   Test Adjustment CR_type Statistic  R     p_val</span></span>
<span><span class="co">#&gt; 1  CWB        CR0     CR0   Naive-F 99 0.2525253</span></span></code></pre></div>
<p>Again, computation speed can sometimes be improved by setting a
parallel processing plan using the <code>future</code> package:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu">parallelly</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/supportsMulticore.html" class="external-link">supportsMulticore</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multicore</span><span class="op">)</span> </span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/nbrOfWorkers.html" class="external-link">nbrOfWorkers</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; system </span></span>
<span><span class="co">#&gt;      4</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">res_para</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Wald_test_cwb.html">Wald_test_cwb</a></span><span class="op">(</span>full_model <span class="op">=</span> <span class="va">rma_model</span>,</span>
<span>                            constraints <span class="op">=</span> <span class="fu"><a href="http://jepusto.github.io/clubSandwich/reference/constraint_matrices.html" class="external-link">constrain_equal</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                            R <span class="op">=</span> <span class="va">reps</span>,</span>
<span>                            seed <span class="op">=</span> <span class="fl">20210314</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   1.753   0.106  19.790</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_para</span></span>
<span><span class="co">#&gt;   Test Adjustment CR_type Statistic  R     p_val</span></span>
<span><span class="co">#&gt; 1  CWB        CR0     CR0   Naive-F 99 0.2525253</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="bootstrap-distribution-plot">Bootstrap Distribution Plot<a class="anchor" aria-label="anchor" href="#bootstrap-distribution-plot"></a>
</h2>
<p>The function <a href="https://meghapsimatrix.github.io/wildmeta/reference/plot.Wald_test_wildmeta.html"><code>plot()</code></a>
creates a <code>ggplot</code> figure representing the distribution of
the bootstrap replicates based on the results from the
<code><a href="../reference/Wald_test_cwb.html">Wald_test_cwb()</a></code> function. The dashed line represents the
<span class="math inline">\(F\)</span> test statistic from the original
full model. The bootstrapped p-value is the proportion of bootstrapped
<span class="math inline">\(F\)</span> test statistics that are greater
than the original <span class="math inline">\(F\)</span> statistic.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, fill <span class="op">=</span> <span class="st">"darkred"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="cwbmeta_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-becker2000multivariate" class="csl-entry">
Becker, B. J. (2000). Multivariate meta-analysis. In <em>Handbook of
applied multivariate statistics and mathematical modeling</em> (pp.
499–525). Elsevier.
</div>
<div id="ref-boos2003introduction" class="csl-entry">
Boos, D. D. et al. (2003). Introduction to the bootstrap world.
<em>Statistical Science</em>, <em>18</em>(2), 168–174.
</div>
<div id="ref-cameron_bootstrap-based_nodate" class="csl-entry">
Cameron, A. C., Gelbach, J. B., &amp; Miller, D. L. (2008).
Bootstrap-based improvements for inference with clustered errors.
<em>The Review of Economics and Statistics</em>, 47.
</div>
<div id="ref-cooper1998synthesizing" class="csl-entry">
Cooper, H. M. (1998). <em>Synthesizing research: A guide for literature
reviews</em> (Vol. 2). Sage.
</div>
<div id="ref-davidson_wild_2008" class="csl-entry">
Davidson, R., &amp; Flachaire, E. (2008). The wild bootstrap, tamed at
last. <em>Journal of Econometrics</em>, <em>146</em>(1), 162–169.
</div>
<div id="ref-davidson2000bootstrap" class="csl-entry">
Davidson, R., &amp; MacKinnon, J. G. (2000). Bootstrap tests: How many
bootstraps? <em>Econometric Reviews</em>, <em>19</em>(1), 55–68.
</div>
<div id="ref-dersimonian1983evaluating" class="csl-entry">
DerSimonian, R., &amp; Laird, N. (1983). Evaluating the effect of
coaching on SAT scores: A meta-analysis. <em>Harvard Educational
Review</em>, <em>53</em>(1), 1–15.
</div>
<div id="ref-robu_2020" class="csl-entry">
Fisher, Z., Tipton, E., &amp; Zhipeng, H. (2017). <em>Robumeta: Robust
variance meta-regression</em>. Retrieved from <a href="https://CRAN.R-project.org/package=robumeta" class="external-link">https://CRAN.R-project.org/package=robumeta</a>
</div>
<div id="ref-freedman1981bootstrapping" class="csl-entry">
Freedman, D. A. (1981). Bootstrapping regression models. <em>The Annals
of Statistics</em>, <em>9</em>(6), 1218–1228.
</div>
<div id="ref-freedman1984bootstrapping" class="csl-entry">
Freedman, D. A. (1984). On bootstrapping two-stage least-squares
estimates in stationary linear models. <em>The Annals of
Statistics</em>, <em>12</em>(3), 827–842.
</div>
<div id="ref-hedges_robust_2010" class="csl-entry">
Hedges, L. V., Tipton, E., &amp; Johnson, M. C. (2010). Robust variance
estimation in meta-regression with dependent effect size estimates.
<em>Research Synthesis Methods</em>, <em>1</em>(1), 39–65. <a href="https://doi.org/10.1002/jrsm.5" class="external-link">https://doi.org/10.1002/jrsm.5</a>
</div>
<div id="ref-joshi2022cluster" class="csl-entry">
Joshi, M., Pustejovsky, J. E., &amp; Beretvas, S. N. (2022). Cluster
wild bootstrapping to handle dependent effect sizes in meta-analysis
with a small number of studies. <em>Research Synthesis Methods</em>. <a href="https://doi.org/10.1002/jrsm.1554" class="external-link">https://doi.org/10.1002/jrsm.1554</a>
</div>
<div id="ref-mackinnon2006bootstrap" class="csl-entry">
MacKinnon, J. G. (2006). Bootstrap methods in econometrics. <em>Economic
Record</em>, <em>82</em>, S2–S18.
</div>
<div id="ref-mackinnon2009bootstrap" class="csl-entry">
MacKinnon, J. G. (2009). Bootstrap hypothesis testing. <em>Handbook of
Computational Econometrics</em>, <em>183</em>, 213.
</div>
<div id="ref-mackinnon2015wild" class="csl-entry">
MacKinnon, J. G. (2015). Wild cluster bootstrap confidence intervals.
<em>L’Actualit<span>é</span> <span>É</span>conomique</em>,
<em>91</em>(1-2), 11–33.
</div>
<div id="ref-pusto_2020" class="csl-entry">
Pustejovsky, J. E. (2020). <em>clubSandwich: Cluster-robust (sandwich)
variance estimators with small-sample corrections</em>. Retrieved from
<a href="https://CRAN.R-project.org/package=clubSandwich" class="external-link">https://CRAN.R-project.org/package=clubSandwich</a>
</div>
<div id="ref-pustejovsky_small-sample_2018" class="csl-entry">
Pustejovsky, J. E., &amp; Tipton, E. (2018). Small-sample methods for
cluster-robust variance estimation and hypothesis testing in fixed
effects models. <em>Journal of Business &amp; Economic Statistics</em>,
<em>36</em>(4), 672–683.
</div>
<div id="ref-pustejovsky2020meta" class="csl-entry">
Pustejovsky, J. E., &amp; Tipton, E. (2021). Meta-analysis with robust
variance estimation: Expanding the range of working models.
<em>Prevention Science</em>.
</div>
<div id="ref-tipton_small_2015" class="csl-entry">
Tipton, E. (2015). Small sample adjustments for robust variance
estimation with meta-regression. <em>Psychological Methods</em>,
<em>20</em>(3), 375.
</div>
<div id="ref-tipton_small-sample_2015" class="csl-entry">
Tipton, E., &amp; Pustejovsky, J. E. (2015). Small-sample adjustments
for tests of moderators and model fit using robust variance estimation
in meta-regression. <em>Journal of Educational and Behavioral
Statistics</em>, <em>40</em>(6), 604–634.
</div>
<div id="ref-viechtbauer2010conducting" class="csl-entry">
Viechtbauer, W. (2010). Conducting meta-analyses in <span>R</span> with
the metafor package. <em>Journal of Statistical Software</em>,
<em>36</em>(3), 1–48.
</div>
<div id="ref-webb2013reworking" class="csl-entry">
Webb, M. D. (2013). <em>Reworking wild bootstrap based inference for
clustered errors</em>. Queen’s Economics Department Working Paper.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://meghapsimatrix.com/" class="external-link">Megha Joshi</a>, <a href="https://www.jepusto.com/" class="external-link">James Pustejovsky</a>, Pierce Cappelli.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
