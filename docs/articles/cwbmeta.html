<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cluster Wild Bootstrapping for Meta-Analysis • wildmeta</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Cluster Wild Bootstrapping for Meta-Analysis">
<meta property="og:description" content="wildmeta">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wildmeta</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cwbmeta.html">Cluster Wild Bootstrapping for Meta-Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/meghapsimatrix/wildmeta">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="cwbmeta_files/header-attrs-2.4.6/header-attrs.js"></script><link href="cwbmeta_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="cwbmeta_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Cluster Wild Bootstrapping for Meta-Analysis</h1>
            
      
      
      <div class="hidden name"><code>cwbmeta.Rmd</code></div>

    </div>

    
    
<div id="dependence-in-meta-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#dependence-in-meta-analysis" class="anchor"></a>Dependence in Meta-Analysis</h2>
<p>Primary studies often contain multiple dependent effect sizes <span class="citation">(Hedges, Tipton, &amp; Johnson, 2010)</span>. Dependent effect sizes can occur through correlated effects structure or hierarchical effects structure or a combination of the two <span class="citation">(Hedges, Tipton, &amp; Johnson, 2010; James E. Pustejovsky &amp; Tipton, 2020)</span>. Correlated effects data structure occurs due to multiple correlated measures of an outcome, repeated measures of the outcome data, or comparison of multiple comparison groups to the same treatment group <span class="citation">(Hedges, Tipton, &amp; Johnson, 2010)</span>. Hierarchical effects structure occurs when primary meta-analysis includes multiple studies conducted by the same lab, researcher, or in the same region <span class="citation">(Hedges, Tipton, &amp; Johnson, 2010)</span>.</p>
<p>The increasingly popular method to handle such dependence, robust variance estimation (RVE), results in inflated Type 1 error rate when the number of studies is small <span class="citation">(Hedges, Tipton, &amp; Johnson, 2010; Tipton, 2015)</span>. <span class="citation">Tipton (2015)</span> and <span class="citation">Tipton &amp; Pustejovsky (2015)</span> have recommended a small sample correction for RVE, called the HTZ test (CR2 Type correction with Satterthwaite degrees of freedom), which has been shown to control Type 1 error rate.</p>
<p>The simulations that I conducted in my dissertation showed that the HTZ test can be very conservative especially for tests of multiple-contrast hypothesis when the number of studies is small. I examined an alternative method, cluster wild bootstrapping (CWB), which controls Type 1 error adequately while providing better power compared to the HTZ test.</p>
<p>The aim of this package is to provide applied meta-analysts functions to implement the CWB test. This vignette provides an overview of the algorithm underlying CWB.</p>
</div>
<div id="bootstrapping" class="section level2">
<h2 class="hasAnchor">
<a href="#bootstrapping" class="anchor"></a>Bootstrapping</h2>
<p>General bootstrapping can be used to estimate measures of uncertainty, even when other methods fail <span class="citation">(Boos &amp; others, 2003)</span>. Bootstrapping involves re-sampling from the original data many times to create an empirical distribution which is used in place of the distribution of an estimate or test statistic <span class="citation">(Boos &amp; others, 2003)</span>.</p>
<p>Several bootstrapping data generating processes are available. The most common one is pair bootstrapping, which involves re-sampling with replacement the set of outcome and covariate data for each case <span class="citation">(Freedman, 1981, 1984)</span>. For data involving clusters, the entire cluster is re-sampled <span class="citation">(Cameron, Gelbach, &amp; Miller, 2008)</span>. In meta-analytic studies with small number of clusters, pairs bootstrapping can result in lack of variance in the distribution of covariates rendering estimation of coefficients infeasible <span class="citation">(Cameron, Gelbach, &amp; Miller, 2008)</span>.</p>
<p>Another type of bootstrapping involves re-sampling residuals <span class="citation">(Cameron, Gelbach, &amp; Miller, 2008)</span>. In case with clusters, entire vector of residuals for each cluster is re-sampled <span class="citation">(Cameron, Gelbach, &amp; Miller, 2008; MacKinnon, 2009)</span>. Such a procedure requires clusters to be of equal size and has an underlying assumption that the errors are independently and identically distributed <span class="citation">(MacKinnon, 2009)</span>.</p>
<p>An ideal way to bootstrap when the number of clusters is small is to use cluster wild bootstrapping, which involves sampling weights and multiplying residuals with the random weights <span class="citation">(Cameron, Gelbach, &amp; Miller, 2008; MacKinnon, 2009)</span>. Unlike pairs bootstrapping, we do not change the distribution of the covariates and unlike residual bootstrapping, CWB does not require clusters have the same size and does not have the underlying assumption that the errors are i.i.d <span class="citation">(Cameron, Gelbach, &amp; Miller, 2008; MacKinnon, 2009)</span>.</p>
<div id="cluster-wild-bootstrapping-steps" class="section level3">
<h3 class="hasAnchor">
<a href="#cluster-wild-bootstrapping-steps" class="anchor"></a>Cluster Wild Bootstrapping Steps</h3>
<p><span class="citation">(MacKinnon, 2009)</span> recommended imposing the null hypothesis when running bootstrap hypothesis tests as the process of hypothesis testing involves examining where the test statistic lies on the the sampling distribution based on the null hypothesis. For weights to use in cluster wild bootstrapping, <span class="citation">MacKinnon (2015)</span> and <span class="citation">Webb (2013)</span> have shown that the Rademacher weights, which take on the values of -1 and 1 with the probability of 0.5 each, outperform all other types of weights for studies with number of clusters as low as 10.</p>
<p>The general process of conducting cluster wild bootstrapping is as follows <span class="citation">(Cameron, Gelbach, &amp; Miller, 2008; MacKinnon, 2009)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a null model and a full model on the original data.</p></li>
<li><p>Obtain residuals from the null model.</p></li>
<li><p>Generate an auxiliary random variable that has mean of 0 and variance of 1 and multiply the residuals by the random variable (e.g., Rademacher weights) set to be constant within clusters (CWB)</p></li>
</ol>
<ul>
<li>The residuals can also be multiplied by CR2 adjustment matrices before multiplying by weights (CWB Adjusted). Adjusting the residuals by CR2 matrices can correct the under-estimation of the error variance when the working model is incorrect <span class="citation">(James E. Pustejovsky &amp; Tipton, 2018)</span>.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><p>Obtain new outcome scores by adding the transformed residuals to the predicted values from the null model fit on the original data.</p></li>
<li><p>Re-estimate the full model with the new calculated outcome scores and obtain the test statistic.</p></li>
<li><p>Repeat steps 3-5 <span class="math inline">\(R\)</span> times. Calculate p-value:</p></li>
</ol>
<p><span class="math display">\[p = \frac{1}{R} \sum_{r = 1}^R I\left(F^{(r)} &gt; F\right)\]</span></p>
<p>The results of the simulation studies that I conducted for my dissertation did not show any difference in Type 1 error rates or power when multiplying the results by CR2 adjustments matrices. However, I did not study major mis-specifications of the working model in my simulation study.</p>
</div>
</div>
<div id="example-from-wildmeta" class="section level2">
<h2 class="hasAnchor">
<a href="#example-from-wildmeta" class="anchor"></a>Example from <code>wildmeta</code>
</h2>
<p>The following example uses the <code>SATCoaching</code> dataset from the <code>clubSandwich</code> package <span class="citation">(James E. Pustejovsky, 2020)</span>, originally from <span class="citation">DerSimonian &amp; Laird (1983)</span>. The standardized mean differences represent the effects of SAT coaching on SAT verbal (SATV) and/or SAT math (SATM) scores. The data contains <code>study_type</code> variable indicating whether groups compared in primary studies were matched, randomized, or non-equivalent.</p>
<p>The code below runs cluster wild bootstrapping to test the multiple-contrast hypothesis that the effect of coaching does not differ based on study type. The <code><a href="../reference/cwb.html">cwb()</a></code> function takes in a full model fit using the <code><a href="https://rdrr.io/pkg/robumeta/man/robu.html">robu()</a></code> function from the <code>robumeta</code> package as an argument. Further, users need to specify the indices to be tested. In the following examples, indices 2 to 3 correspond to the the second and third category levels of the <code>study_type</code> variable. Users can specify the number of bootstrap replications R. The default value is set to 999. In the example below, I set the value to 99 for speed up computation time.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://meghapsimatrix.github.io/wildmeta/index.html">wildmeta</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jepusto/clubSandwich">clubSandwich</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zackfisher/robumeta">robumeta</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12102020</span><span class="op">)</span>


<span class="va">full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/robumeta/man/robu.html">robu</a></span><span class="op">(</span><span class="va">d</span> <span class="op">~</span> <span class="va">study_type</span>,
             studynum <span class="op">=</span> <span class="va">study</span>,
             var.eff.size <span class="op">=</span> <span class="va">V</span>,
             small <span class="op">=</span> <span class="cn">FALSE</span>,
             data <span class="op">=</span> <span class="va">SATcoaching</span><span class="op">)</span>


<span class="fu"><a href="../reference/cwb.html">cwb</a></span><span class="op">(</span>full_model <span class="op">=</span> <span class="va">full</span>,
    indices <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,
    R <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>
<span class="co">#&gt;   test     p_val</span>
<span class="co">#&gt; 1  CWB 0.5252525</span></pre></div>
<p>The users can also specify whether to adjust the residuals with CR2 matrices when bootstrapping as below. The default value for the <code>adjust</code> argument is set to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">20201228</span><span class="op">)</span>

<span class="fu"><a href="../reference/cwb.html">cwb</a></span><span class="op">(</span>full_model <span class="op">=</span> <span class="va">full</span>,
    indices <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,
    R <span class="op">=</span> <span class="fl">99</span>,
    adjust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;           test     p_val</span>
<span class="co">#&gt; 1 CWB Adjusted 0.6161616</span></pre></div>
<div id="timing" class="section level3">
<h3 class="hasAnchor">
<a href="#timing" class="anchor"></a>Timing</h3>
<p>The <code><a href="../reference/cwb.html">cwb()</a></code> function takes around 30 seconds to 1 minute to run even with high number of bootstrap replications. Below is an example with 999 bootstrap replications.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">20201229</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/cwb.html">cwb</a></span><span class="op">(</span>full_model <span class="op">=</span> <span class="va">full</span>,
    indices <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,
    R <span class="op">=</span> <span class="fl">999</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;  32.009   0.244  33.110</span></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-boos2003introduction" class="csl-entry">
Boos, D. D., &amp; others. (2003). Introduction to the bootstrap world. <em>Statistical Science</em>, <em>18</em>(2), 168–174.
</div>
<div id="ref-cameron_bootstrap-based_nodate" class="csl-entry">
Cameron, A. C., Gelbach, J. B., &amp; Miller, D. L. (2008). Bootstrap-<span>Based</span> <span>Improvements</span> for <span>Inference</span> with <span>Clustered</span> <span>Errors</span>. <em>The Review of Economics and Statistics</em>, 47.
</div>
<div id="ref-dersimonian1983evaluating" class="csl-entry">
DerSimonian, R., &amp; Laird, N. (1983). Evaluating the effect of coaching on SAT scores: A meta-analysis. <em>Harvard Educational Review</em>, <em>53</em>(1), 1–15.
</div>
<div id="ref-freedman1981bootstrapping" class="csl-entry">
Freedman, D. A. (1981). Bootstrapping regression models. <em>The Annals of Statistics</em>, <em>9</em>(6), 1218–1228.
</div>
<div id="ref-freedman1984bootstrapping" class="csl-entry">
Freedman, D. A. (1984). On bootstrapping two-stage least-squares estimates in stationary linear models. <em>The Annals of Statistics</em>, <em>12</em>(3), 827–842.
</div>
<div id="ref-hedges_robust_2010" class="csl-entry">
Hedges, L. V., Tipton, E., &amp; Johnson, M. C. (2010). Robust variance estimation in meta-regression with dependent effect size estimates. <em>Research Synthesis Methods</em>, <em>1</em>(1), 39–65. <a href="https://doi.org/10.1002/jrsm.5">https://doi.org/10.1002/jrsm.5</a>
</div>
<div id="ref-mackinnon2009bootstrap" class="csl-entry">
MacKinnon, J. G. (2009). Bootstrap hypothesis testing. <em>Handbook of Computational Econometrics</em>, <em>183</em>, 213.
</div>
<div id="ref-mackinnon2015wild" class="csl-entry">
MacKinnon, J. G. (2015). Wild cluster bootstrap confidence intervals. <em>L’Actualit<span>é</span> <span>é</span>conomique</em>, <em>91</em>(1-2), 11–33.
</div>
<div id="ref-pusto_2020" class="csl-entry">
Pustejovsky, James E. (2020). <em>clubSandwich: Cluster-robust (sandwich) variance estimators with small-sample corrections</em>. Retrieved from <a href="https://CRAN.R-project.org/package=clubSandwich">https://CRAN.R-project.org/package=clubSandwich</a>
</div>
<div id="ref-pustejovsky_small-sample_2018" class="csl-entry">
Pustejovsky, James E., &amp; Tipton, E. (2018). Small-<span>Sample</span> <span>Methods</span> for <span>Cluster</span>-<span>Robust</span> <span>Variance</span> <span>Estimation</span> and <span>Hypothesis</span> <span>Testing</span> in <span>Fixed</span> <span>Effects</span> <span>Models</span>. <em>Journal of Business &amp; Economic Statistics</em>, <em>36</em>(4), 672–683. <a href="https://doi.org/10.1080/07350015.2016.1247004">https://doi.org/10.1080/07350015.2016.1247004</a>
</div>
<div id="ref-pustejovsky2020meta" class="csl-entry">
Pustejovsky, James E., &amp; Tipton, E. (2020). <em>Meta-analysis with robust variance estimation: Expanding the range of working models</em>.
</div>
<div id="ref-tipton_small_2015" class="csl-entry">
Tipton, E. (2015). Small sample adjustments for robust variance estimation with meta-regression. <em>Psychological Methods</em>, <em>20</em>(3), 375–393. <a href="https://doi.org/10.1037/met0000011">https://doi.org/10.1037/met0000011</a>
</div>
<div id="ref-tipton_small-sample_2015" class="csl-entry">
Tipton, E., &amp; Pustejovsky, J. E. (2015). Small-<span>Sample</span> <span>Adjustments</span> for <span>Tests</span> of <span>Moderators</span> and <span>Model</span> <span>Fit</span> <span>Using</span> <span>Robust</span> <span>Variance</span> <span>Estimation</span> in <span>Meta</span>-<span>Regression</span>. <em>Journal of Educational and Behavioral Statistics</em>, <em>40</em>(6), 604–634. <a href="https://doi.org/10.3102/1076998615606099">https://doi.org/10.3102/1076998615606099</a>
</div>
<div id="ref-webb2013reworking" class="csl-entry">
Webb, M. D. (2013). <em>Reworking wild bootstrap based inference for clustered errors</em>. Queen’s Economics Department Working Paper.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://meghapsimatrix.com">Megha Joshi</a>, <a href="https://www.jepusto.com/">James Pustejovsky</a>, Pierce Cappelli.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
